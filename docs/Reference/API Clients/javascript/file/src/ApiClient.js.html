<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/ApiClient.js | estuary-client</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="This_is_the_API_for_the_Estuary_application_"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="estuary-client"><meta property="twitter:description" content="This_is_the_API_for_the_Estuary_application_"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/ApiClient.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/*
 * Pin.Storage API
 * This is the API for the Pin.Storage application.
 *
 * OpenAPI spec version: 0.0.0
 *
 * NOTE: This class is auto generated by the swagger code generator program.
 * https://github.com/swagger-api/swagger-codegen.git
 *
 * Swagger Codegen version: 2.4.28
 *
 * Do not edit the class manually.
 *
 */

(function(root, factory) {
  if (typeof define === &apos;function&apos; &amp;&amp; define.amd) {
    // AMD. Register as an anonymous module.
    define([&apos;superagent&apos;, &apos;querystring&apos;], factory);
  } else if (typeof module === &apos;object&apos; &amp;&amp; module.exports) {
    // CommonJS-like environments that support module.exports, like Node.
    module.exports = factory(require(&apos;superagent&apos;), require(&apos;querystring&apos;));
  } else {
    // Browser globals (root is window)
    if (!root.EstuaryClient) {
      root.EstuaryClient = {};
    }
    root.EstuaryClient.ApiClient = factory(root.superagent, root.querystring);
  }
}(this, function(superagent, querystring) {
  &apos;use strict&apos;;

  /**
   * @module ApiClient
   * @version 1.0.1
   */

  /**
   * Manages low level client-server communications, parameter marshalling, etc. There should not be any need for an
   * application to use this class directly - the *Api and model classes provide the public API for the service. The
   * contents of this file should be regarded as internal but are documented for completeness.
   * @alias module:ApiClient
   * @class
   */
  var exports = function() {
    /**
     * The base URL against which to resolve every API call&apos;s (relative) path.
     * @type {String}
     * @default https://api.pin.storage
     */
    this.basePath = &apos;https://api.pin.storage&apos;.replace(/\/+$/, &apos;&apos;);

    /**
     * The authentication methods to be included for all API calls.
     * @type {Array.&lt;String&gt;}
     */
    this.authentications = {
      &apos;bearerAuth&apos;: {type: &apos;apiKey&apos;, &apos;in&apos;: &apos;header&apos;, name: &apos;Authorization&apos;}
    };
    /**
     * The default HTTP headers to be included for all API calls.
     * @type {Array.&lt;String&gt;}
     * @default {}
     */
    this.defaultHeaders = {};

    /**
     * The default HTTP timeout for all API calls.
     * @type {Number}
     * @default 60000
     */
    this.timeout = 60000;

    /**
     * If set to false an additional timestamp parameter is added to all API GET calls to
     * prevent browser caching
     * @type {Boolean}
     * @default true
     */
    this.cache = true;

    /**
     * If set to true, the client will save the cookies from each server
     * response, and return them in the next request.
     * @default false
     */
    this.enableCookies = false;

    /*
     * Used to save and return cookies in a node.js (non-browser) setting,
     * if this.enableCookies is set to true.
     */
    if (typeof window === &apos;undefined&apos;) {
      this.agent = new superagent.agent();
    }

    /*
     * Allow user to override superagent agent
     */
    this.requestAgent = null;
  };

  /**
   * Returns a string representation for an actual parameter.
   * @param param The actual parameter.
   * @returns {String} The string representation of &lt;code&gt;param&lt;/code&gt;.
   */
  exports.prototype.paramToString = function(param) {
    if (param == undefined || param == null) {
      return &apos;&apos;;
    }
    if (param instanceof Date) {
      return param.toISOString();
    }
    return param.toString();
  };

  /**
   * Builds full URL by appending the given path to the base URL and replacing path parameter place-holders with parameter values.
   * NOTE: query parameters are not handled here.
   * @param {String} path The path to append to the base URL.
   * @param {Object} pathParams The parameter values to append.
   * @returns {String} The encoded path with parameter values substituted.
   */
  exports.prototype.buildUrl = function(path, pathParams) {
    if (!path.match(/^\//)) {
      path = &apos;/&apos; + path;
    }
    var url = this.basePath + path;
    var _this = this;
    url = url.replace(/\{([\w-]+)\}/g, function(fullMatch, key) {
      var value;
      if (pathParams.hasOwnProperty(key)) {
        value = _this.paramToString(pathParams[key]);
      } else {
        value = fullMatch;
      }
      return encodeURIComponent(value);
    });
    return url;
  };

  /**
   * Checks whether the given content type represents JSON.&lt;br&gt;
   * JSON content type examples:&lt;br&gt;
   * &lt;ul&gt;
   * &lt;li&gt;application/json&lt;/li&gt;
   * &lt;li&gt;application/json; charset=UTF8&lt;/li&gt;
   * &lt;li&gt;APPLICATION/JSON&lt;/li&gt;
   * &lt;/ul&gt;
   * @param {String} contentType The MIME content type to check.
   * @returns {Boolean} &lt;code&gt;true&lt;/code&gt; if &lt;code&gt;contentType&lt;/code&gt; represents JSON, otherwise &lt;code&gt;false&lt;/code&gt;.
   */
  exports.prototype.isJsonMime = function(contentType) {
    return Boolean(contentType != null &amp;&amp; contentType.match(/^application\/json(;.*)?$/i));
  };

  /**
   * Chooses a content type from the given array, with JSON preferred; i.e. return JSON if included, otherwise return the first.
   * @param {Array.&lt;String&gt;} contentTypes
   * @returns {String} The chosen content type, preferring JSON.
   */
  exports.prototype.jsonPreferredMime = function(contentTypes) {
    for (var i = 0; i &lt; contentTypes.length; i++) {
      if (this.isJsonMime(contentTypes[i])) {
        return contentTypes[i];
      }
    }
    return contentTypes[0];
  };

  /**
   * Checks whether the given parameter value represents file-like content.
   * @param param The parameter to check.
   * @returns {Boolean} &lt;code&gt;true&lt;/code&gt; if &lt;code&gt;param&lt;/code&gt; represents a file.
   */
  exports.prototype.isFileParam = function(param) {
    // fs.ReadStream in Node.js and Electron (but not in runtime like browserify)
    if (typeof require === &apos;function&apos;) {
      var fs;
      try {
        fs = require(&apos;fs&apos;);
      } catch (err) {}
      if (fs &amp;&amp; fs.ReadStream &amp;&amp; param instanceof fs.ReadStream) {
        return true;
      }
    }
    // Buffer in Node.js
    if (typeof Buffer === &apos;function&apos; &amp;&amp; param instanceof Buffer) {
      return true;
    }
    // Blob in browser
    if (typeof Blob === &apos;function&apos; &amp;&amp; param instanceof Blob) {
      return true;
    }
    // File in browser (it seems File object is also instance of Blob, but keep this for safe)
    if (typeof File === &apos;function&apos; &amp;&amp; param instanceof File) {
      return true;
    }
    return false;
  };

  /**
   * Normalizes parameter values:
   * &lt;ul&gt;
   * &lt;li&gt;remove nils&lt;/li&gt;
   * &lt;li&gt;keep files and arrays&lt;/li&gt;
   * &lt;li&gt;format to string with `paramToString` for other cases&lt;/li&gt;
   * &lt;/ul&gt;
   * @param {Object.&lt;String, Object&gt;} params The parameters as object properties.
   * @returns {Object.&lt;String, Object&gt;} normalized parameters.
   */
  exports.prototype.normalizeParams = function(params) {
    var newParams = {};
    for (var key in params) {
      if (params.hasOwnProperty(key) &amp;&amp; params[key] != undefined &amp;&amp; params[key] != null) {
        var value = params[key];
        if (this.isFileParam(value) || Array.isArray(value)) {
          newParams[key] = value;
        } else {
          newParams[key] = this.paramToString(value);
        }
      }
    }
    return newParams;
  };

  /**
   * Enumeration of collection format separator strategies.
   * @enum {String}
   * @readonly
   */
  exports.CollectionFormatEnum = {
    /**
     * Comma-separated values. Value: &lt;code&gt;csv&lt;/code&gt;
     * @const
     */
    CSV: &apos;,&apos;,
    /**
     * Space-separated values. Value: &lt;code&gt;ssv&lt;/code&gt;
     * @const
     */
    SSV: &apos; &apos;,
    /**
     * Tab-separated values. Value: &lt;code&gt;tsv&lt;/code&gt;
     * @const
     */
    TSV: &apos;\t&apos;,
    /**
     * Pipe(|)-separated values. Value: &lt;code&gt;pipes&lt;/code&gt;
     * @const
     */
    PIPES: &apos;|&apos;,
    /**
     * Native array. Value: &lt;code&gt;multi&lt;/code&gt;
     * @const
     */
    MULTI: &apos;multi&apos;
  };

  /**
   * Builds a string representation of an array-type actual parameter, according to the given collection format.
   * @param {Array} param An array parameter.
   * @param {module:ApiClient.CollectionFormatEnum} collectionFormat The array element separator strategy.
   * @returns {String|Array} A string representation of the supplied collection, using the specified delimiter. Returns
   * &lt;code&gt;param&lt;/code&gt; as is if &lt;code&gt;collectionFormat&lt;/code&gt; is &lt;code&gt;multi&lt;/code&gt;.
   */
  exports.prototype.buildCollectionParam = function buildCollectionParam(param, collectionFormat) {
    if (param == null) {
      return null;
    }
    switch (collectionFormat) {
      case &apos;csv&apos;:
        return param.map(this.paramToString).join(&apos;,&apos;);
      case &apos;ssv&apos;:
        return param.map(this.paramToString).join(&apos; &apos;);
      case &apos;tsv&apos;:
        return param.map(this.paramToString).join(&apos;\t&apos;);
      case &apos;pipes&apos;:
        return param.map(this.paramToString).join(&apos;|&apos;);
      case &apos;multi&apos;:
        // return the array directly as SuperAgent will handle it as expected
        return param.map(this.paramToString);
      default:
        throw new Error(&apos;Unknown collection format: &apos; + collectionFormat);
    }
  };

  /**
   * Applies authentication headers to the request.
   * @param {Object} request The request object created by a &lt;code&gt;superagent()&lt;/code&gt; call.
   * @param {Array.&lt;String&gt;} authNames An array of authentication method names.
   */
  exports.prototype.applyAuthToRequest = function(request, authNames) {
    var _this = this;
    authNames.forEach(function(authName) {
      var auth = _this.authentications[authName];
      switch (auth.type) {
        case &apos;basic&apos;:
          if (auth.username || auth.password) {
            request.auth(auth.username || &apos;&apos;, auth.password || &apos;&apos;);
          }
          break;
        case &apos;apiKey&apos;:
          if (auth.apiKey) {
            var data = {};
            if (auth.apiKeyPrefix) {
              data[auth.name] = auth.apiKeyPrefix + &apos; &apos; + auth.apiKey;
            } else {
              data[auth.name] = auth.apiKey;
            }
            if (auth[&apos;in&apos;] === &apos;header&apos;) {
              request.set(data);
            } else {
              request.query(data);
            }
          }
          break;
        case &apos;oauth2&apos;:
          if (auth.accessToken) {
            request.set({&apos;Authorization&apos;: &apos;Bearer &apos; + auth.accessToken});
          }
          break;
        default:
          throw new Error(&apos;Unknown authentication type: &apos; + auth.type);
      }
    });
  };

  /**
   * Deserializes an HTTP response body into a value of the specified type.
   * @param {Object} response A SuperAgent response object.
   * @param {(String|Array.&lt;String&gt;|Object.&lt;String, Object&gt;|Function)} returnType The type to return. Pass a string for simple types
   * or the constructor function for a complex type. Pass an array containing the type name to return an array of that type. To
   * return an object, pass an object with one property whose name is the key type and whose value is the corresponding value type:
   * all properties on &lt;code&gt;data&lt;code&gt; will be converted to this type.
   * @returns A value of the specified type.
   */
  exports.prototype.deserialize = function deserialize(response, returnType) {
    if (response == null || returnType == null || response.status == 204) {
      return null;
    }
    // Rely on SuperAgent for parsing response body.
    // See http://visionmedia.github.io/superagent/#parsing-response-bodies
    var data = response.body;
    if (data == null || (typeof data === &apos;object&apos; &amp;&amp; typeof data.length === &apos;undefined&apos; &amp;&amp; !Object.keys(data).length)) {
      // SuperAgent does not always produce a body; use the unparsed response as a fallback
      data = response.text;
    }
    return exports.convertToType(data, returnType);
  };

  /**
   * Callback function to receive the result of the operation.
   * @callback module:ApiClient~callApiCallback
   * @param {String} error Error message, if any.
   * @param data The data returned by the service call.
   * @param {String} response The complete HTTP response.
   */

  /**
   * Invokes the REST service using the supplied settings and parameters.
   * @param {String} path The base URL to invoke.
   * @param {String} httpMethod The HTTP method to use.
   * @param {Object.&lt;String, String&gt;} pathParams A map of path parameters and their values.
   * @param {Object.&lt;String, Object&gt;} queryParams A map of query parameters and their values.
   * @param {Object.&lt;String, Object&gt;} collectionQueryParams A map of collection query parameters and their values.
   * @param {Object.&lt;String, Object&gt;} headerParams A map of header parameters and their values.
   * @param {Object.&lt;String, Object&gt;} formParams A map of form parameters and their values.
   * @param {Object} bodyParam The value to pass as the request body.
   * @param {Array.&lt;String&gt;} authNames An array of authentication type names.
   * @param {Array.&lt;String&gt;} contentTypes An array of request MIME types.
   * @param {Array.&lt;String&gt;} accepts An array of acceptable response MIME types.
   * @param {(String|Array|ObjectFunction)} returnType The required type to return; can be a string for simple types or the
   * constructor for a complex type.
   * @param {module:ApiClient~callApiCallback} callback The callback function.
   * @returns {Object} The SuperAgent request object.
   */
  exports.prototype.callApi = function callApi(path, httpMethod, pathParams,
      queryParams, collectionQueryParams, headerParams, formParams, bodyParam, authNames, contentTypes, accepts,
      returnType, callback) {

    var _this = this;
    var url = this.buildUrl(path, pathParams);
    var request = superagent(httpMethod, url);

    // apply authentications
    this.applyAuthToRequest(request, authNames);

    // set collection query parameters
    for (var key in collectionQueryParams) {
      if (collectionQueryParams.hasOwnProperty(key)) {
        var param = collectionQueryParams[key];
        if (param.collectionFormat === &apos;csv&apos;) {
          // SuperAgent normally percent-encodes all reserved characters in a query parameter. However,
          // commas are used as delimiters for the &apos;csv&apos; collectionFormat so they must not be encoded. We
          // must therefore construct and encode &apos;csv&apos; collection query parameters manually.
          if (param.value != null) {
            var value = param.value.map(this.paramToString).map(encodeURIComponent).join(&apos;,&apos;);
            request.query(encodeURIComponent(key) + &quot;=&quot; + value);
          }
        } else {
          // All other collection query parameters should be treated as ordinary query parameters.
          queryParams[key] = this.buildCollectionParam(param.value, param.collectionFormat);
        }
      }
    }

    // set query parameters
    if (httpMethod.toUpperCase() === &apos;GET&apos; &amp;&amp; this.cache === false) {
        queryParams[&apos;_&apos;] = new Date().getTime();
    }
    request.query(this.normalizeParams(queryParams));

    // set header parameters
    request.set(this.defaultHeaders).set(this.normalizeParams(headerParams));


    // set requestAgent if it is set by user
    if (this.requestAgent) {
      request.agent(this.requestAgent);
    }

    // set request timeout
    request.timeout(this.timeout);

    var contentType = this.jsonPreferredMime(contentTypes);
    if (contentType) {
      // Issue with superagent and multipart/form-data (https://github.com/visionmedia/superagent/issues/746)
      if(contentType != &apos;multipart/form-data&apos;) {
        request.type(contentType);
      }
    } else if (!request.header[&apos;Content-Type&apos;]) {
      request.type(&apos;application/json&apos;);
    }

    if (contentType === &apos;application/x-www-form-urlencoded&apos;) {
      request.send(querystring.stringify(this.normalizeParams(formParams)));
    } else if (contentType == &apos;multipart/form-data&apos;) {
      var _formParams = this.normalizeParams(formParams);
      for (var key in _formParams) {
        if (_formParams.hasOwnProperty(key)) {
          if (this.isFileParam(_formParams[key])) {
            // file field
            request.attach(key, _formParams[key]);
          } else {
            request.field(key, _formParams[key]);
          }
        }
      }
    } else if (bodyParam) {
      request.send(bodyParam);
    }

    var accept = this.jsonPreferredMime(accepts);
    if (accept) {
      request.accept(accept);
    }

    if (returnType === &apos;Blob&apos;) {
      request.responseType(&apos;blob&apos;);
    } else if (returnType === &apos;String&apos;) {
      request.responseType(&apos;string&apos;);
    }

    // Attach previously saved cookies, if enabled
    if (this.enableCookies){
      if (typeof window === &apos;undefined&apos;) {
        this.agent.attachCookies(request);
      }
      else {
        request.withCredentials();
      }
    }


    request.end(function(error, response) {
      if (callback) {
        var data = null;
        if (!error) {
          try {
            data = _this.deserialize(response, returnType);
            if (_this.enableCookies &amp;&amp; typeof window === &apos;undefined&apos;){
              _this.agent.saveCookies(response);
            }
          } catch (err) {
            error = err;
          }
        }
        callback(error, data, response);
      }
    });

    return request;
  };

  /**
   * Parses a string representation of a date value.
   * @param {String} str The date value as an ISO-8601 full-date or date-time string.
   * @returns {Date} The parsed date object.
   */
  exports.parseDate = function(str) {
    // OpenAPI 2.0 &amp; 3.0 specs state that:
    // - date values are serialized as ISO-8601 full-date strings. 
    // - date-time values are serialized as ISO-8601 date-time strings, in which the timezone offset is mandatory. 
    return new Date(str);
  };

  /**
   * Converts a value to the specified type.
   * @param {(String|Object)} data The data to convert, as a string or object.
   * @param {(String|Array.&lt;String&gt;|Object.&lt;String, Object&gt;|Function)} type The type to return. Pass a string for simple types
   * or the constructor function for a complex type. Pass an array containing the type name to return an array of that type. To
   * return an object, pass an object with one property whose name is the key type and whose value is the corresponding value type:
   * all properties on &lt;code&gt;data&lt;code&gt; will be converted to this type.
   * @returns An instance of the specified type or null or undefined if data is null or undefined.
   */
  exports.convertToType = function(data, type) {
    if (data === null || data === undefined)
      return data

    switch (type) {
      case &apos;Boolean&apos;:
        return Boolean(data);
      case &apos;Integer&apos;:
        return parseInt(data, 10);
      case &apos;Number&apos;:
        return parseFloat(data);
      case &apos;String&apos;:
        return String(data);
      case &apos;Date&apos;:
        return this.parseDate(String(data));
      case &apos;Blob&apos;:
      	return data;
      default:
        if (type === Object) {
          // generic object, return directly
          return data;
        } else if (typeof type === &apos;function&apos;) {
          // for model type like: User
          return type.constructFromObject(data);
        } else if (Array.isArray(type)) {
          // for array type like: [&apos;String&apos;]
          var itemType = type[0];
          return data.map(function(item) {
            return exports.convertToType(item, itemType);
          });
        } else if (typeof type === &apos;object&apos;) {
          // for plain object type like: {&apos;String&apos;: &apos;Integer&apos;}
          var keyType, valueType;
          for (var k in type) {
            if (type.hasOwnProperty(k)) {
              keyType = k;
              valueType = type[k];
              break;
            }
          }
          var result = {};
          for (var k in data) {
            if (data.hasOwnProperty(k)) {
              var key = exports.convertToType(k, keyType);
              var value = exports.convertToType(data[k], valueType);
              result[key] = value;
            }
          }
          return result;
        } else {
          // for unknown type, return the data directly
          return data;
        }
    }
  };

  /**
   * Constructs a new map or array model from REST data.
   * @param data {Object|Array} The REST data.
   * @param obj {Object|Array} The target object or array.
   */
  exports.constructFromObject = function(data, obj, itemType) {
    if (Array.isArray(data)) {
      for (var i = 0; i &lt; data.length; i++) {
        if (data.hasOwnProperty(i))
          obj[i] = exports.convertToType(data[i], itemType);
      }
    } else {
      for (var k in data) {
        if (data.hasOwnProperty(k))
          obj[k] = exports.convertToType(data[k], itemType);
      }
    }
  };

  /**
   * The default API client implementation.
   * @type {module:ApiClient}
   */
  exports.instance = new exports();

  return exports;
}));
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
